# 打牌记账 · 转积分版设计

按你的需求：**开房间 → 二维码/微信邀请进房 → 房间里每人有头像，点头像给 TA 转积分 → 对局结束看统计**。不做底分、自摸等规则。

---

## 一、整体流程

```
开房间 → 得到「邀请入口」（二维码 + 微信分享）
    ↓
其他人：扫码 或 点分享链接 → 加入房间
    ↓
房间内：所有人显示头像 + 当前积分
    ↓
操作：点击某人头像 → 弹窗「转给 TA 多少积分」→ 确认后：我 -N，TA +N
    ↓
房主（或大家）点「结束对局」→ 展示本局统计（每人积分、排名）
```

---

## 二、功能清单（精简）

| 功能 | 说明 |
|------|------|
| 开房间 | 只填房间名（或默认「牌局 + 时间」），生成邀请码 + 二维码 + 分享链接 |
| 邀请进房 | 二维码扫码加入 / 微信「发送给好友」邀请加入 |
| 房间成员 | 列表展示：头像、昵称、当前积分；自己可区分显示 |
| 转积分 | 点击某人头像 → 输入「转给 TA 多少分」→ 我扣分、TA 加分（零和） |
| 结束对局 | 房主点「结束对局」→ 所有人看到最终积分与排名，可截图/分享 |

不做的：底分、自摸/点炮、按局记分、游戏类型/结算模式选择。

---

## 三、页面与界面设计

### 3.1 首页 / 牌局列表

- **没有房间时**：一个大按钮「开一局」；一个「加入一局」（扫码 or 输入邀请码，二选一或都保留）。
- **有房间时**：列表展示「进行中的房间」，每项：房间名、人数、我的积分（可选）。点击进入该房间。

不展示「游戏类型、底分、局数」等，只关心「房间名 + 人 + 积分」。

---

### 3.2 开房间

- **唯一必填**：房间名（可默认「牌局 3月5日」这类）。
- **点击「开房」后**：  
  - 创建房间成功 → **直接进入「邀请页」**（或弹层）：  
    - 大二维码（别人扫码进房）  
    - 按钮「微信邀请」→ 调起分享，好友点链接进房  

不做：游戏类型、结算模式、底分、人数上限等设置（以后若要再加「高级设置」可折叠）。

---

### 3.3 邀请进房（开房后的邀请页）

两种入口二选一或并存：

- **方式 A**：开房成功后，当前页就是「邀请页」：中间大二维码，下面「微信邀请」按钮；顶部可显示房间名、邀请码（6 位，可复制）。
- **方式 B**：开房后先进「房间内页」，顶部有「邀请」按钮，点开弹出二维码 + 微信邀请。

建议：**开房成功后先到邀请页**，方便立刻发二维码/分享；同时有「进入房间」按钮，点进房间内。

界面示意：

```
┌─────────────────────────────────────┐
│  邀请好友进房                   [×] │
├─────────────────────────────────────┤
│  房间名：周五夜局                    │
│  邀请码：A1B2C3  [复制]              │
│                                     │
│     ┌─────────────────────────┐     │
│     │                         │     │
│     │    [ 二维码 图片 ]       │     │
│     │    扫码加入房间          │     │
│     │                         │     │
│     └─────────────────────────┘     │
│                                     │
│  [  微信邀请好友  ]                  │
│                                     │
│  [  进入房间  ]                     │
└─────────────────────────────────────┘
```

---

### 3.4 房间内（核心页）

- **顶部**：房间名；邀请按钮（点开即二维码 + 微信邀请）；房主可见「结束对局」。
- **主体**：**成员列表**，每人一行或一块卡片：
  - **头像**（大一点，可点）
  - **昵称**
  - **当前积分**（显眼，如 +12、-5、0）
  - 可选：自己是「我」角标或高亮

- **交互**：  
  - **点击某人头像（或整块成员卡片）** → 弹出「转积分」弹窗。  
  - 弹窗内容：  
    - 对方头像 + 昵称  
    - 输入框：「转给 TA 多少积分」（数字，可带 + 号或默认正数表示「我给他」）  
    - 可选：快捷按钮 +1 / +5 / +10  
    - 说明：「转出后你的积分减少，对方增加」  
    - 按钮「确认」  
  - 确认后：当前房间内，我的积分 -N，对方积分 +N；实时更新列表。

- **不展示**：底分、局数、自摸/点炮、单局记录列表（若你以后要「记录每笔转积分」可再加一栏「流水」）。

界面示意：

```
┌─────────────────────────────────────┐
│  周五夜局          [邀请] [结束对局]  │
├─────────────────────────────────────┤
│                                     │
│  成员与积分（点击头像给 TA 转积分）   │
│                                     │
│  ┌──────┐  ┌──────┐  ┌──────┐       │
│  │ 头像 │  │ 头像 │  │ 头像 │  ...  │
│  │ 老张 │  │ 老李 │  │  我  │       │
│  │ +12  │  │ -5   │  │ -7  │       │
│  └──────┘  └──────┘  └──────┘       │
│     ↑          ↑          ↑         │
│   点击转积分  点击转积分   (自己)     │
│                                     │
│  或列表形式：                        │
│  [头像] 老张    +12   ← 点击整行     │
│  [头像] 老李     -5                  │
│  [头像] 我      -7                   │
└─────────────────────────────────────┘
```

**转积分弹窗示意：**

```
┌─────────────────────────────────────┐
│  转给 老张 积分                 [×] │
├─────────────────────────────────────┤
│  [老张头像]  老张                   │
│                                     │
│  转出积分  [  10  ]                 │
│  [ +1 ]  [ +5 ]  [ +10 ]  [ +20 ]   │
│                                     │
│  确认后：你的积分 -10，老张 +10      │
│                                     │
│  [      确认转出      ]              │
└─────────────────────────────────────┘
```

---

### 3.5 结束对局（统计页 / 弹层）

- **触发**：房主在房间内点「结束对局」；可选二次确认「确定结束？结束后将显示本局统计」。
- **展示**：  
  - 房间名  
  - 本局统计：每人一行，**头像 + 昵称 + 最终积分**，按积分从高到低排（或按名次 1、2、3、4）  
  - 可说明：「正数=赢，负数=输」  
  - 按钮：「保存/截图」「分享给好友」（可选）

界面示意：

```
┌─────────────────────────────────────┐
│  本局统计 · 周五夜局             [×] │
├─────────────────────────────────────┤
│  排名  成员    积分                 │
│  1     [头像] 老张   +24             │
│  2     [头像] 老李   +3              │
│  3     [头像] 老王   -10             │
│  4     [头像] 我     -17             │
│                                     │
│  [ 保存截图 ]  [ 分享给好友 ]        │
└─────────────────────────────────────┘
```

结束后房间可标记为「已结束」，列表中进房只读查看统计，不再允许转积分（或你们约定仍可查看历史）。

---

## 四、数据与规则（简化）

- **房间**：房间名、邀请码、二维码（可用邀请码生成）、状态（进行中 / 已结束）、成员列表（openid、昵称、头像、**当前积分**）。
- **积分**：仅在本房间内有效；初始每人 0；每次「转积分」：转出方 -N，转入方 +N，房间总积分保持为 0。
- **不存**：底分、局数、自摸/点炮、单局明细（若以后要可再加「转积分流水」表）。

---

## 五、和当前版本的差异小结

| 项目 | 当前 | 转积分版 |
|------|------|----------|
| 开房 | 房间名+游戏类型+结算模式+底分 | 只房间名（或默认） |
| 邀请 | 邀请码+复制/分享 | 二维码 + 微信邀请，邀请码保留可复制 |
| 房间内 | 积分榜+「添加记录」按局填分 | 成员列表（头像+积分），**点头像 → 转积分** |
| 记分方式 | 每局每人填得分、保证和为 0 | 只做「转给谁多少」，自动零和 |
| 结束 | 结束房间+游戏记录列表 | 结束对局 → 统计页（排名+积分），可分享 |

---

## 六、建议实现顺序

1. **开房**：只保留房间名，去掉游戏类型/结算模式/底分；开房成功后跳「邀请页」。
2. **邀请页**：大二维码 +「微信邀请」+ 邀请码复制 +「进入房间」。
3. **房间内**：成员列表（头像、昵称、当前积分）；点击成员 →「转积分」弹窗 → 确认后更新两人积分。
4. **结束对局**：房主按钮 → 确认 → 统计页（排名+最终积分），可选分享。

如果你愿意，我可以再根据现有代码结构，帮你标出「要删/要改/要新增」的页面和接口，方便直接开发。

---

## 七、房间内界面示意图

见：`assets/majiang-room-转积分-房间内.png`（成员头像 + 积分，点击头像即转积分）