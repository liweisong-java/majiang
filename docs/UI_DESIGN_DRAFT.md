# 打牌记账小程序 · UI 简化方案初稿

## 一、当前痛点

| 问题 | 表现 |
|------|------|
| **入口分散** | 首页、牌局 Tab、FAB 都有「创建/加入」，用户不知道先点哪 |
| **开房步骤多** | 创建房间要填：房间名、游戏类型、结算模式、底分，多数对局其实用默认即可 |
| **记一局操作重** | 添加记录要给每个人输入得分+备注，还要自己算总和为 0，容易输错 |
| **页面层级深** | 首页 → 牌局列表 → 房间详情 → 添加记录，每次记一局要点很多次 |

---

## 二、设计目标

- **少步骤**：默认配置一键开房；记一局尽量「选谁胡」即可，系统自动算分
- **少跳转**：首页即「牌局中心」，一个页面完成「没局就开/加入、有局就进」
- **主操作唯一**：当前最该做的事（开局 / 记一局）大而明显，次要入口收起来

---

## 三、新信息架构（简化后）

```
Tab1: 牌局（原首页+牌局合并）
  ├─ 无进行中房间 → 大卡片：「开一局」「加入一局」
  ├─ 有进行中房间 → 置顶「当前牌局」卡片，点进即房间详情
  └─ 下方：历史牌局列表（可折叠）

Tab2: 牌友（保留）

Tab3: 我的（原统计 + 个人设置合并）
  ├─ 头像/昵称/简要统计
  └─ 个人记账、历史统计入口
```

**删除/合并：**

- 独立「首页」与「牌局」合并为一个 Tab「牌局」
- 「统计」与用户信息合并为「我的」
- 创建房间支持「一键默认开房」，可选「高级设置」展开名称/类型/底分

---

## 四、页面级 UI 初稿

### 4.1 牌局 Tab（新首页）

**状态 A：没有进行中的房间**

```
┌─────────────────────────────────────┐
│  牌局                          [···] │
├─────────────────────────────────────┤
│                                     │
│     ┌─────────────────────────┐     │
│     │                         │     │
│     │   🎲 开一局              │     │
│     │   默认：麻将·记分·底分1   │     │
│     │                         │     │
│     └─────────────────────────┘     │
│                                     │
│     ┌─────────────────────────┐     │
│     │   🔗 加入一局            │     │
│     │   输入邀请码 / 扫码      │     │
│     └─────────────────────────┘     │
│                                     │
│  ─── 历史牌局（点击展开）────────     │
│                                     │
└─────────────────────────────────────┘
  [ 牌局 ]    [ 牌友 ]    [ 我的 ]
```

**状态 B：有进行中的房间**

```
┌─────────────────────────────────────┐
│  牌局                          [···] │
├─────────────────────────────────────┤
│  当前牌局                            │
│  ┌───────────────────────────────┐   │
│  │ 周五夜局 · 记分 底分1元        │   │
│  │ 4人 · 已玩 8 局               │   │
│  │ [记一局]  [邀请]  [设置]      │   │  ← 记一局主按钮
│  └───────────────────────────────┘   │
│                                     │
│  [ 开新局 ]  [ 加入一局 ]  （小按钮）  │
│                                     │
│  ─── 历史牌局 ───────────────────    │
│  · 周三小局  已结束  …               │
│  · 上周夜局  已结束  …               │
└─────────────────────────────────────┘
```

**交互要点：**

- 有当前牌局时，「记一局」放在卡片上，减少一次进入房间详情的必须步骤（可选：记一局后弹窗确认再回列表，或直接进房间详情）
- 开一局：点击后可选「直接用默认」或「先设置再开」

---

### 4.2 一键开房（创建房间简化）

**方案一：底部弹出**

```
┌─────────────────────────────────────┐
│  开一局                              │
├─────────────────────────────────────┤
│  房间名  [ 周五夜局        ] 选填   │
│  默认：麻将 · 记分 · 底分 1 元       │
│                                     │
│  [ 高级设置 ▼ ]   （折叠：类型/底分） │
│                                     │
│  ┌─────────────────────────────┐    │
│  │      开始                    │    │
│  └─────────────────────────────┘    │
└─────────────────────────────────────┘
```

**方案二：全屏但只保留最少项**

- 仅「房间名」可选填，其余用默认
- 底部一个大按钮「开始」，不再单独「创建房间」文案

---

### 4.3 快速记一局（添加记录简化）

**当前：** 每人输入得分 + 备注 → 自己保证总和为 0。

**初稿：以「谁胡牌」为核心**

```
┌─────────────────────────────────────┐
│  记一局 · 第 9 局              [×]  │
├─────────────────────────────────────┤
│  谁胡了？                            │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐       │
│  │ 老张│ │ 老李│ │ 老王│ │ 我 │       │  ← 选一个
│  └────┘ └────┘ └────┘ └────┘       │
│                                     │
│  胡牌方式                           │
│  [ 自摸 ]  [ 点炮 ]                  │
│  点炮时可选：谁点炮（可选）          │
│                                     │
│  本局底分  [ 1 ] 元  （可改）        │
│                                     │
│  ── 自动换算 ──                     │
│  老张 +8  老李 -4  老王 -2  我 -2    │  ← 仅展示，不可编辑（或可微调）
│  总和 0 ✓                            │
│                                     │
│  ┌─────────────────────────────┐    │
│  │      确认                   │    │
│  └─────────────────────────────┘    │
└─────────────────────────────────────┘
```

**规则约定（可配置）：**

- 自摸：胡牌 +底分×3，其余各 -底分×1
- 点炮：胡牌 +底分×1，点炮者 -底分×1，其余 0（或按你们规则微调）
- 若需要「每人单独改分」，可保留「高级」展开为当前的全员输入

---

### 4.4 加入一局（保持简单）

- 保留：输入 6 位邀请码 + 扫码
- 可放在牌局 Tab 的「加入一局」后，或从 Tab 顶栏 [···] 进入，二选一统一即可

---

### 4.5 房间详情（收敛操作）

- 顶部：房间名、局数、邀请码、邀请按钮
- 中部：实时积分榜（保持现有）
- 主操作：**记一局**（跳简化版添加记录）
- 次要：结束房间、游戏记录列表、设置（改名称/底分等）

---

### 4.6 我的 Tab

```
┌─────────────────────────────────────┐
│  我的                               │
├─────────────────────────────────────┤
│  [头像]  昵称                        │
│          总对局 12  胜 5  负 7       │
│                                     │
│  [ 个人记账 ]  [ 对局统计 ]          │
│                                     │
│  设置 · 关于                         │
└─────────────────────────────────────┘
```

---

## 五、优先级建议

| 优先级 | 改动 | 说明 |
|--------|------|------|
| P0 | 牌局 Tab 合并 + 当前牌局置顶 + 卡片上「记一局」 | 减少层级，主路径清晰 |
| P0 | 添加记录改为「选谁胡 + 自摸/点炮」自动算分 | 大幅减少输入与算错 |
| P1 | 一键开房（默认配置 + 可选高级设置） | 开房步骤从 4 步到 1 步 |
| P2 | 首页/牌局/统计 Tab 合并为 牌局 / 牌友 / 我的 | 减少 Tab 数量，信息更集中 |

---

## 六、小结

- **牌局 Tab** 作为唯一「牌局中心」：没局就大按钮开/加入，有局就当前牌局卡片 + 记一局。
- **记一局** 从「每人填分」改为「选谁胡 + 自摸/点炮」自动算分，必要时再展开高级编辑。
- **开房** 支持默认配置一键开，高级设置折叠。
- **Tab** 收敛为三个：牌局、牌友、我的。

如需下一步，可先实现 P0（牌局 Tab 合并 + 快速记一局交互），再补一键开房与 Tab 合并。

---

## 七、附图（初稿示意图）

- **牌局 Tab（有当前牌局时）**：`assets/majiang-ui-draft-tab-牌局.png`
- **快速记一局**：`assets/majiang-ui-draft-快速记一局.png`
