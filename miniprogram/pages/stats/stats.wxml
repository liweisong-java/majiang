<view class="container">
  <navigation-bar title="ç»Ÿè®¡" back="{{false}}"></navigation-bar>

  <scroll-view
    class="content"
    scroll-y
    style="padding-top: {{navBarHeight}}px;"
    enable-back-to-top
    refresher-enabled
    refresher-triggered="{{loading}}"
    bindrefresherrefresh="onPullDownRefresh"
  >
    <block wx:if="{{loading}}">
      <view class="skeleton-banner"></view>
      <view class="skeleton-card"></view>
    </block>

    <view wx:if="{{!loading && overallStats}}">

      <!-- æœ‰æ•°æ®æ—¶æ˜¾ç¤ºç»Ÿè®¡ -->
      <block wx:if="{{overallStats.totalGames > 0}}">

        <!-- â‘  é¡¶éƒ¨ Banner -->
        <view class="banner">
          <view class="banner-bg-circle c1"></view>
          <view class="banner-bg-circle c2"></view>
          <view class="banner-bg-circle c3"></view>

          <view class="banner-main">
            <text class="banner-eyebrow">ç´¯è®¡ç§¯åˆ†</text>
            <text class="banner-score {{overallStats.totalScoreChange > 0 ? 'pos' : overallStats.totalScoreChange < 0 ? 'neg' : ''}}">
              {{overallStats.totalScoreChange > 0 ? '+' : ''}}{{overallStats.totalScoreChange}}
            </text>
            <text class="banner-sub">å…± {{overallStats.totalGames}} åœºå¯¹å±€ Â· åœºå‡ {{overallStats.averageScore > 0 ? '+' : ''}}{{averageScoreText}}</text>
          </view>

          <!-- èƒœç‡å¼§å½¢ï¼š--pct ç›´æ¥è®¾åœ¨ arc-track ä¸Š -->
          <view class="arc-wrap">
            <view
              class="arc-track"
              style="--pct:{{overallStats.totalGames > 0 ? overallStats.totalWins / overallStats.totalGames : 0}}"
            ></view>
            <view class="arc-center">
              <text class="arc-value">{{winRateText}}%</text>
              <text class="arc-label">èƒœç‡</text>
            </view>
          </view>
        </view>

        <!-- â‘¡ èƒœè´Ÿå¹³ä¸‰æ ¼ -->
        <view class="record-row">
          <view class="record-cell win">
            <view class="record-dot win-dot"></view>
            <text class="record-num">{{overallStats.totalWins}}</text>
            <text class="record-tag">èƒœ</text>
          </view>
          <view class="record-cell draw">
            <view class="record-dot draw-dot"></view>
            <text class="record-num">{{overallStats.totalGames - overallStats.totalWins - overallStats.totalLosses}}</text>
            <text class="record-tag">å¹³</text>
          </view>
          <view class="record-cell loss">
            <view class="record-dot loss-dot"></view>
            <text class="record-num">{{overallStats.totalLosses}}</text>
            <text class="record-tag">è´Ÿ</text>
          </view>
        </view>

        <!-- â‘¢ èƒœè´Ÿè¿›åº¦æ¡ -->
        <view class="bar-card">
          <view class="bar-labels">
            <text class="bar-label-win">èƒœ {{overallStats.totalWins}}</text>
            <text class="bar-label-loss">è´Ÿ {{overallStats.totalLosses}}</text>
          </view>
          <view class="bar-track">
            <view class="bar-win"  style="flex: {{overallStats.totalWins > 0 ? overallStats.totalWins : 0.01}}"></view>
            <view class="bar-draw" style="flex: {{overallStats.totalGames - overallStats.totalWins - overallStats.totalLosses > 0 ? overallStats.totalGames - overallStats.totalWins - overallStats.totalLosses : 0.01}}"></view>
            <view class="bar-loss" style="flex: {{overallStats.totalLosses > 0 ? overallStats.totalLosses : 0.01}}"></view>
          </view>
        </view>

      </block>

      <!-- ç©ºçŠ¶æ€ -->
      <view wx:else class="empty-wrap">
        <text class="empty-icon">ğŸ€„</text>
        <text class="empty-title">è¿˜æ²¡æœ‰å¯¹å±€è®°å½•</text>
        <text class="empty-desc">å®Œæˆä¸€å±€åæ•°æ®å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</text>
      </view>

    </view>
  </scroll-view>
</view>
