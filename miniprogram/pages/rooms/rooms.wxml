<view class="container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <navigation-bar title="ç‰Œå±€" back="{{false}}"></navigation-bar>

  <!-- Tab åˆ‡æ¢ï¼ˆç´§è´´å¯¼èˆªæ ï¼‰ -->
  <view class="tabs" style="top: {{navBarHeight}}px;">
    <view
      class="tab-item {{currentTab === index ? 'active' : ''}}"
      wx:for="{{tabs}}"
      wx:key="value"
      data-index="{{index}}"
      bindtap="onTabClick"
    >
      <text class="tab-label">{{item.label}}</text>
      <view class="tab-indicator" wx:if="{{currentTab === index}}"></view>
    </view>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view class="content" style="padding-top: {{navBarHeight + 100}}px;">
    <swiper
      class="swiper"
      style="height: calc(100vh - {{navBarHeight + 100}}px);"
      current="{{currentTab}}"
      bindchange="onTabChange"
    >
      <!-- è¿›è¡Œä¸­çš„æˆ¿é—´ -->
      <swiper-item class="swiper-item">
        <scroll-view
          class="scroll-view"
          scroll-y
          enable-back-to-top
          refresher-enabled
          refresher-triggered="{{loading}}"
          bindrefresherrefresh="onPullDownRefresh"
        >
          <view class="room-list">
            <!-- éª¨æž¶å± -->
            <block wx:if="{{loading}}">
              <skeleton type="room-card"></skeleton>
              <skeleton type="room-card"></skeleton>
              <skeleton type="room-card"></skeleton>
            </block>

            <view wx:elif="{{activeRooms.length > 0}}" class="list-content">
              <room-card
                wx:for="{{activeRooms}}"
                wx:key="_id"
                room="{{item}}"
                myBalance="{{item.myBalance}}"
                bind:tap="onRoomTap">
              </room-card>
            </view>

            <empty-state
              wx:else
              type="game"
              message="è¿˜æ²¡æœ‰è¿›è¡Œä¸­çš„ç‰Œå±€"
              buttonText="åˆ›å»ºæˆ¿é—´"
              bind:buttontap="onCreateRoom">
            </empty-state>
          </view>
        </scroll-view>
      </swiper-item>

      <!-- å·²ç»“æŸçš„æˆ¿é—´ -->
      <swiper-item class="swiper-item">
        <scroll-view
          class="scroll-view"
          scroll-y
          enable-back-to-top
          refresher-enabled
          refresher-triggered="{{loading}}"
          bindrefresherrefresh="onPullDownRefresh"
        >
          <view class="room-list">
            <!-- éª¨æž¶å± -->
            <block wx:if="{{loading}}">
              <skeleton type="room-card"></skeleton>
              <skeleton type="room-card"></skeleton>
              <skeleton type="room-card"></skeleton>
            </block>

            <view wx:elif="{{settledRooms.length > 0}}" class="list-content">
              <room-card
                wx:for="{{settledRooms}}"
                wx:key="_id"
                room="{{item}}"
                myBalance="{{item.myBalance}}"
                bind:tap="onRoomTap">
              </room-card>
            </view>

            <empty-state
              wx:else
              type="game"
              message="è¿˜æ²¡æœ‰å·²ç»“æŸçš„ç‰Œå±€"
              buttonText="">
            </empty-state>
          </view>
        </scroll-view>
      </swiper-item>
    </swiper>

    <!-- æµ®åŠ¨æ“ä½œæŒ‰é’® -->
    <view class="fab-group">
      <view class="fab-item" bindtap="onJoinRoom">
        <text class="fab-icon">ðŸ”—</text>
      </view>
      <view class="fab-item primary" bindtap="onCreateRoom">
        <text class="fab-icon">âž•</text>
      </view>
    </view>
  </view>
</view>
